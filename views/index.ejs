<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sakinah - Platform Undangan Digital</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Config Fonts & Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { gold: '#D4AF37', dark: '#1F2937', light: '#F9FAFB', primary: '#4F46E5' }
                    },
                    fontFamily: {
                        script: ['"Great Vibes"', 'cursive'],
                        sans: ['"Inter"', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@300;400;600;700&display=swap');
        .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans antialiased">

    <!-- Notifikasi Error -->
    <% if (typeof error !== 'undefined' && error) { %>
        <div class="fixed top-5 right-5 z-50 bg-red-500 text-white px-6 py-4 rounded-xl shadow-2xl animate-fade-in flex items-center gap-3">
            <i class="fas fa-exclamation-triangle"></i> <span><%= error %></span>
        </div>
    <% } %>

    <!-- ================= 1. AUTH SECTION (LOGIN/REGISTER) ================= -->
    <% if (mode === 'auth') { %>
        <div class="min-h-screen flex w-full">
            <!-- Sisi Kiri: Visual -->
            <div class="hidden lg:flex w-1/2 bg-brand-dark relative items-center justify-center overflow-hidden">
                <div class="absolute inset-0 opacity-40 bg-[url('https://images.unsplash.com/photo-1511795409834-ef04bbd61622?q=80&w=2000&auto=format&fit=crop')] bg-cover bg-center"></div>
                <div class="relative z-10 text-center text-white p-12">
                    <h1 class="font-script text-7xl mb-4 text-brand-gold">Sakinah</h1>
                    <p class="text-xl font-light tracking-wide">Buat Undangan Pernikahan Impian Anda<br>Dalam Hitungan Menit</p>
                </div>
            </div>

            <!-- Sisi Kanan: Form -->
            <div class="w-full lg:w-1/2 flex items-center justify-center p-8 bg-white">
                <div class="w-full max-w-md animate-fade-in">
                    <div class="lg:hidden text-center mb-8">
                        <h1 class="font-script text-5xl text-brand-gold">Sakinah</h1>
                    </div>
                    
                    <div class="bg-white rounded-2xl p-2 mb-8 flex border border-gray-100 bg-gray-50">
                        <button onclick="toggleAuth('login')" id="btn-login" class="flex-1 py-3 rounded-xl font-bold transition-all shadow-sm bg-white text-brand-dark">Masuk</button>
                        <button onclick="toggleAuth('register')" id="btn-register" class="flex-1 py-3 rounded-xl font-bold transition-all text-gray-400 hover:text-gray-600">Daftar</button>
                    </div>

                    <!-- Login Form -->
                    <form id="login-form" action="/login" method="POST" class="space-y-5">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Email / Username</label>
                            <!-- Input type text agar bisa menerima username 'admin' -->
                            <input type="text" name="email" required class="w-full px-5 py-3 rounded-xl border border-gray-200 focus:border-brand-gold focus:ring-2 focus:ring-brand-gold/20 outline-none transition-all" placeholder="email@anda.com atau admin">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                            <input type="password" name="password" required class="w-full px-5 py-3 rounded-xl border border-gray-200 focus:border-brand-gold focus:ring-2 focus:ring-brand-gold/20 outline-none transition-all" placeholder="••••••••">
                        </div>
                        <button type="submit" class="w-full bg-brand-dark text-white py-4 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg shadow-brand-dark/20">Masuk Sekarang</button>
                    </form>

                    <!-- Register Form -->
                    <form id="register-form" action="/register" method="POST" class="space-y-5 hidden">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Nama Lengkap</label>
                            <input type="text" name="name" required class="w-full px-5 py-3 rounded-xl border border-gray-200 focus:border-brand-gold focus:ring-2 focus:ring-brand-gold/20 outline-none" placeholder="Nama Anda">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                            <input type="email" name="email" required class="w-full px-5 py-3 rounded-xl border border-gray-200 focus:border-brand-gold focus:ring-2 focus:ring-brand-gold/20 outline-none" placeholder="nama@email.com">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                            <input type="password" name="password" required class="w-full px-5 py-3 rounded-xl border border-gray-200 focus:border-brand-gold focus:ring-2 focus:ring-brand-gold/20 outline-none" placeholder="••••••••">
                        </div>
                        <button type="submit" class="w-full bg-brand-gold text-white py-4 rounded-xl font-bold hover:bg-yellow-600 transition-all shadow-lg shadow-brand-gold/20">Buat Akun Baru</button>
                    </form>
                </div>
            </div>
        </div>
        <script>
            function toggleAuth(t){
                const l=document.getElementById('login-form'), r=document.getElementById('register-form');
                const bl=document.getElementById('btn-login'), br=document.getElementById('btn-register');
                if(t==='login'){
                    l.classList.remove('hidden'); r.classList.add('hidden');
                    bl.className='flex-1 py-3 rounded-xl font-bold transition-all shadow-sm bg-white text-brand-dark';
                    br.className='flex-1 py-3 rounded-xl font-bold transition-all text-gray-400 hover:text-gray-600';
                }else{
                    l.classList.add('hidden'); r.classList.remove('hidden');
                    br.className='flex-1 py-3 rounded-xl font-bold transition-all shadow-sm bg-white text-brand-dark';
                    bl.className='flex-1 py-3 rounded-xl font-bold transition-all text-gray-400 hover:text-gray-600';
                }
            }
        </script>
    <% } %>

    <!-- ================= 2. SUPER ADMIN DASHBOARD ================= -->
    <% if (mode === 'superadmin') { %>
        <div class="min-h-screen bg-gray-100 font-sans">
            <nav class="bg-brand-dark text-white shadow-lg sticky top-0 z-50">
                <div class="max-w-7xl mx-auto px-4 h-20 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-shield-alt text-brand-gold text-2xl"></i>
                        <span class="font-bold text-xl tracking-wide">Administrator Panel</span>
                    </div>
                    <a href="/" class="px-4 py-2 bg-red-600 rounded hover:bg-red-700 transition font-bold text-sm">Keluar</a>
                </div>
            </nav>

            <main class="max-w-7xl mx-auto py-10 px-4">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Kelola Pengguna</h1>
                <p class="text-gray-600 mb-8">Verifikasi pengguna baru agar mereka dapat login dan membuat undangan.</p>

                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider">Nama</th>
                                    <th class="px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider">Email</th>
                                    <th class="px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider">Tanggal Daftar</th>
                                    <th class="px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-4 text-xs font-bold text-gray-500 uppercase tracking-wider text-right">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <% if(users.length === 0) { %>
                                    <tr><td colspan="5" class="px-6 py-8 text-center text-gray-400">Belum ada user terdaftar.</td></tr>
                                <% } %>
                                <% users.forEach(u => { %>
                                    <tr class="hover:bg-gray-50 transition">
                                        <td class="px-6 py-4 whitespace-nowrap font-medium text-gray-900"><%= u.name %></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-gray-600"><%= u.email %></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-gray-500 text-sm"><%= new Date(u.created_at).toLocaleDateString() %></td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <% if (u.is_verified) { %>
                                                <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"><i class="fas fa-check-circle mr-1"></i> Aktif</span>
                                            <% } else { %>
                                                <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800"><i class="fas fa-clock mr-1"></i> Menunggu</span>
                                            <% } %>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <div class="flex justify-end gap-3">
                                                <% if (!u.is_verified) { %>
                                                    <form action="/admin/verify" method="POST">
                                                        <input type="hidden" name="user_id_to_verify" value="<%= u.id %>">
                                                        <button type="submit" class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition shadow-sm text-xs font-bold">Verifikasi</button>
                                                    </form>
                                                <% } %>
                                                <form action="/admin/delete-user" method="POST" onsubmit="return confirm('Hapus user ini beserta semua undangannya? Tindakan ini tidak dapat dibatalkan.')">
                                                    <input type="hidden" name="user_id_to_delete" value="<%= u.id %>">
                                                    <button type="submit" class="bg-gray-100 text-gray-600 px-3 py-1 rounded hover:bg-red-100 hover:text-red-600 transition text-xs"><i class="fas fa-trash"></i></button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                <% }) %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    <% } %>

    <!-- ================= 3. USER DASHBOARD ================= -->
    <% if (mode === 'dashboard') { %>
        <div class="min-h-screen bg-gray-50 flex flex-col">
            <!-- Navbar -->
            <nav class="bg-white border-b border-gray-200 sticky top-0 z-40">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-brand-gold rounded-full flex items-center justify-center text-white font-script text-xl">S</div>
                        <span class="font-bold text-xl tracking-tight text-gray-900">Sakinah Dashboard</span>
                    </div>
                    <div class="flex items-center gap-6">
                        <div class="hidden md:flex flex-col text-right">
                            <span class="text-sm font-bold text-gray-900"><%= user.name %></span>
                            <span class="text-xs text-gray-500">Member</span>
                        </div>
                        <a href="/" class="text-gray-500 hover:text-red-500 transition-colors"><i class="fas fa-sign-out-alt text-xl"></i></a>
                    </div>
                </div>
            </nav>

            <!-- Content -->
            <main class="flex-grow max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-10">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900">Undangan Saya</h1>
                        <p class="text-gray-500 mt-1">Kelola, bagikan, atau buat undangan baru.</p>
                    </div>
                    <a href="/create?user_id=<%= user.id %>" class="group flex items-center gap-2 bg-brand-dark text-white px-6 py-3 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg hover:shadow-xl">
                        <i class="fas fa-plus transition-transform group-hover:rotate-90"></i> Buat Undangan
                    </a>
                </div>

                <% if (invitations.length === 0) { %>
                    <div class="bg-white rounded-3xl border-2 border-dashed border-gray-200 p-20 text-center">
                        <div class="w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="far fa-heart text-3xl text-gray-300"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Belum ada undangan</h3>
                        <p class="text-gray-500 mb-6">Buat undangan pernikahan pertama Anda sekarang.</p>
                        <a href="/create?user_id=<%= user.id %>" class="text-brand-gold font-bold hover:underline">Mulai Membuat &rarr;</a>
                    </div>
                <% } else { %>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <% invitations.forEach(inv => { 
                            const dateObj = new Date(inv.event_date);
                            const dateStr = dateObj.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });
                        %>
                            <div class="group bg-white rounded-2xl shadow-sm hover:shadow-xl border border-gray-100 overflow-hidden transition-all duration-300 flex flex-col">
                                <!-- Card Header -->
                                <div class="h-32 bg-gradient-to-r from-gray-800 to-gray-900 relative p-6 flex items-end">
                                    <div class="absolute top-0 right-0 p-3 opacity-10"><i class="fas fa-heart text-6xl text-white"></i></div>
                                    <h3 class="text-white font-script text-3xl relative z-10 truncate w-full"><%= inv.groom_nick %> & <%= inv.bride_nick %></h3>
                                </div>
                                
                                <!-- Card Body -->
                                <div class="p-6 flex-grow">
                                    <div class="flex items-center gap-3 text-sm text-gray-600 mb-3">
                                        <div class="w-8 h-8 rounded-lg bg-orange-100 text-orange-600 flex items-center justify-center"><i class="far fa-calendar"></i></div>
                                        <span><%= dateStr %></span>
                                    </div>
                                    <div class="flex items-center gap-3 text-sm text-gray-600">
                                        <div class="w-8 h-8 rounded-lg bg-blue-100 text-blue-600 flex items-center justify-center"><i class="fas fa-map-marker-alt"></i></div>
                                        <span class="truncate"><%= inv.location.substring(0, 30) %>...</span>
                                    </div>
                                </div>

                                <!-- Card Footer (Actions) -->
                                <div class="p-4 border-t border-gray-50 bg-gray-50/50 flex flex-col gap-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <a href="/u/<%= inv.id %>" target="_blank" class="flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-bold text-gray-700 bg-white border border-gray-200 hover:bg-gray-50 transition-all">
                                            <i class="far fa-eye"></i> Lihat
                                        </a>
                                        <!-- Share WhatsApp -->
                                        <button onclick="shareToWA('<%= inv.id %>', '<%= inv.groom_nick %>', '<%= inv.bride_nick %>')" class="flex items-center justify-center gap-2 py-2 rounded-lg text-sm font-bold text-white bg-green-600 hover:bg-green-700 transition-all shadow-sm">
                                            <i class="fab fa-whatsapp"></i> Bagikan
                                        </button>
                                    </div>
                                    
                                    <!-- Delete Button -->
                                    <form action="/delete-invitation" method="POST" onsubmit="return confirm('Yakin ingin menghapus undangan ini? Data tidak bisa dikembalikan.')" class="mt-1">
                                        <input type="hidden" name="invitation_id" value="<%= inv.id %>">
                                        <input type="hidden" name="user_id" value="<%= user.id %>">
                                        <button type="submit" class="w-full flex items-center justify-center gap-2 py-2 rounded-lg text-xs font-bold text-red-500 hover:text-red-700 hover:bg-red-50 transition-all">
                                            <i class="far fa-trash-alt"></i> Hapus Undangan
                                        </button>
                                    </form>
                                </div>
                            </div>
                        <% }) %>
                    </div>
                <% } %>
            </main>
        </div>
        
        <script>
            function shareToWA(id, groom, bride) {
                const url = window.location.origin + '/u/' + id;
                const text = `Kepada Yth. Bapak/Ibu/Saudara/i,\n\nTanpa mengurangi rasa hormat, perkenankan kami mengundang Bapak/Ibu/Saudara/i untuk hadir dan memberikan doa restu pada acara pernikahan kami:\n\n*${groom} & ${bride}*\n\nBerikut link undangan kami untuk info lengkap acara:\n${url}\n\nMerupakan suatu kehormatan dan kebahagiaan bagi kami apabila Bapak/Ibu/Saudara/i berkenan hadir.\n\nTerima kasih.`;
                const waLink = `https://wa.me/?text=${encodeURIComponent(text)}`;
                window.open(waLink, '_blank');
            }
        </script>
    <% } %>

    <!-- ================= 4. CREATE FORM SECTION ================= -->
    <% if (mode === 'create') { %>
        <section class="min-h-screen bg-gray-50 pb-20">
            <nav class="bg-white border-b border-gray-200 sticky top-0 z-40">
                <div class="max-w-5xl mx-auto px-4 h-20 flex items-center justify-between">
                    <a href="/?user_id=<%= user.id %>" class="flex items-center gap-2 text-gray-500 hover:text-brand-dark transition-colors font-bold">
                        <i class="fas fa-arrow-left"></i> Kembali
                    </a>
                    <h1 class="font-bold text-xl text-gray-900">Buat Undangan Baru</h1>
                    <div class="w-20"></div> 
                </div>
            </nav>

            <div class="max-w-4xl mx-auto px-4 mt-10">
                <form action="/create" method="POST" enctype="multipart/form-data" class="space-y-8">
                    <input type="hidden" name="user_id" value="<%= user.id %>">
                    
                    <!-- 1. Data Mempelai -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="bg-brand-dark p-6 text-white flex items-center gap-4">
                            <div class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"><i class="fas fa-user-friends"></i></div>
                            <div><h3 class="font-bold text-lg">Data Mempelai</h3><p class="text-sm text-gray-300">Informasi utama pengantin</p></div>
                        </div>
                        <div class="p-8 grid md:grid-cols-2 gap-8">
                            <!-- Pria -->
                            <div class="space-y-4">
                                <h4 class="font-bold text-brand-gold border-b pb-2">Mempelai Pria</h4>
                                <div><label class="text-xs font-bold text-gray-500 uppercase">Nama Lengkap</label><input type="text" name="groomName" required class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-brand-gold/20 outline-none transition-all"></div>
                                <div><label class="text-xs font-bold text-gray-500 uppercase">Nama Panggilan</label><input type="text" name="groomNick" required class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-brand-gold/20 outline-none transition-all"></div>
                                <div><label class="text-xs font-bold text-gray-500 uppercase">Foto Profil</label><input type="file" name="groomPhoto" accept="image/*" class="w-full mt-1 text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200"></div>
                            </div>
                            <!-- Wanita -->
                            <div class="space-y-4">
                                <h4 class="font-bold text-brand-gold border-b pb-2">Mempelai Wanita</h4>
                                <div><label class="text-xs font-bold text-gray-500 uppercase">Nama Lengkap</label><input type="text" name="brideName" required class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-brand-gold/20 outline-none transition-all"></div>
                                <div><label class="text-xs font-bold text-gray-500 uppercase">Nama Panggilan</label><input type="text" name="brideNick" required class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-brand-gold/20 outline-none transition-all"></div>
                                <div><label class="text-xs font-bold text-gray-500 uppercase">Foto Profil</label><input type="file" name="bridePhoto" accept="image/*" class="w-full mt-1 text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Acara & Lokasi -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="bg-indigo-600 p-6 text-white flex items-center gap-4">
                            <div class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"><i class="fas fa-calendar-alt"></i></div>
                            <div><h3 class="font-bold text-lg">Waktu & Tempat</h3><p class="text-sm text-indigo-100">Kapan dan dimana acara dilaksanakan</p></div>
                        </div>
                        <div class="p-8 space-y-6">
                            <div><label class="text-xs font-bold text-gray-500 uppercase">Tanggal & Waktu Akad</label><input type="datetime-local" name="eventDate" required class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-indigo-500/20 outline-none"></div>
                            <div><label class="text-xs font-bold text-gray-500 uppercase">Lokasi Lengkap</label><textarea name="location" rows="2" required class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-indigo-500/20 outline-none" placeholder="Nama Gedung, Jalan, Kota..."></textarea></div>
                            <div><label class="text-xs font-bold text-gray-500 uppercase">Quote / Ayat Suci</label><textarea name="message" rows="3" class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-indigo-500/20 outline-none" placeholder="Tuliskan ayat atau kata mutiara..."></textarea></div>
                        </div>
                    </div>

                    <!-- 3. Amplop Digital -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="bg-green-600 p-6 text-white flex items-center gap-4">
                            <div class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"><i class="fas fa-wallet"></i></div>
                            <div><h3 class="font-bold text-lg">Amplop Digital</h3><p class="text-sm text-green-100">Rekening untuk hadiah (Opsional)</p></div>
                        </div>
                        <div class="p-8 grid md:grid-cols-3 gap-6">
                            <div><label class="text-xs font-bold text-gray-500 uppercase">Nama Bank</label><input type="text" name="bankName" class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50" placeholder="BCA / Mandiri"></div>
                            <div><label class="text-xs font-bold text-gray-500 uppercase">No. Rekening</label><input type="text" name="accountNumber" class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50" placeholder="1234xxxx"></div>
                            <div><label class="text-xs font-bold text-gray-500 uppercase">Atas Nama</label><input type="text" name="accountHolder" class="w-full mt-1 px-4 py-2 border rounded-lg bg-gray-50" placeholder="Pemilik Rekening"></div>
                        </div>
                    </div>

                    <!-- 4. Love Story -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="bg-pink-600 p-6 text-white flex items-center gap-4">
                            <div class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"><i class="fas fa-heart"></i></div>
                            <div><h3 class="font-bold text-lg">Kisah Cinta</h3><p class="text-sm text-pink-100">Perjalanan cinta kalian (Maks 3 momen)</p></div>
                        </div>
                        <div class="p-8 space-y-6">
                            <% for(let i=1; i<=3; i++) { %>
                                <div class="bg-pink-50 p-4 rounded-xl border border-pink-100">
                                    <div class="grid grid-cols-12 gap-4 mb-2">
                                        <div class="col-span-3"><input type="text" name="story_year_<%=i%>" placeholder="Tahun" class="w-full px-3 py-2 border rounded bg-white text-sm"></div>
                                        <div class="col-span-9"><input type="text" name="story_title_<%=i%>" placeholder="Judul Momen" class="w-full px-3 py-2 border rounded bg-white text-sm"></div>
                                    </div>
                                    <textarea name="story_content_<%=i%>" rows="2" placeholder="Ceritakan sedikit tentang momen ini..." class="w-full px-3 py-2 border rounded bg-white text-sm"></textarea>
                                </div>
                            <% } %>
                        </div>
                    </div>

                    <!-- 5. Galeri Foto -->
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="bg-gray-800 p-6 text-white flex items-center gap-4">
                            <div class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center"><i class="fas fa-camera"></i></div>
                            <div><h3 class="font-bold text-lg">Galeri Foto</h3><p class="text-sm text-gray-400">Upload momen prewedding</p></div>
                        </div>
                        <div class="p-8 grid grid-cols-2 gap-6">
                            <% for(let i=1; i<=4; i++) { %>
                                <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:bg-gray-50 transition-colors">
                                    <label class="block text-xs font-bold text-gray-500 mb-2">Foto Galeri <%= i %></label>
                                    <input type="file" name="gallery_<%=i%>" accept="image/*" class="w-full text-xs text-gray-500 file:mr-2 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-gray-200 file:text-gray-700 hover:file:bg-gray-300"/>
                                </div>
                            <% } %>
                        </div>
                    </div>

                    <div class="flex justify-end pt-4 pb-10">
                        <button type="submit" class="px-8 py-4 bg-brand-gold text-white font-bold rounded-xl shadow-lg hover:bg-yellow-600 transition-all transform hover:-translate-y-1 w-full md:w-auto">
                            <i class="fas fa-check-circle mr-2"></i> Simpan & Buat Undangan
                        </button>
                    </div>
                </form>
            </div>
        </section>
    <% } %>

</body>
</html>